"use strict";(self.webpackChunke58f99bf_e6ab_459a_a3ef_c08879907507=self.webpackChunke58f99bf_e6ab_459a_a3ef_c08879907507||[]).push([[748],{1077:(e,n,a)=>{a.r(n),a.d(n,{default:()=>V});var t=a(4914),r=a.n(t),o=a(7049),i=a(1244),l=a(3436),s=a(8976),d=a(3082),c=a(1330),A=a(6594),u=a(7125),m=a(7381),g=a(260),p=a(6118),b=a(313),f=a(774),h=a(1133),E=a(759);const x=(0,h.Wp)({apiKey:"AIzaSyDqW8Mcav0opCXNvQOptRL8zhV19pwdazw",authDomain:"quizdatabase-6eda3.firebaseapp.com",projectId:"quizdatabase-6eda3",storageBucket:"quizdatabase-6eda3.firebasestorage.app",messagingSenderId:"741614543682",appId:"1:741614543682:web:4cbb172200a8fccd3c5edb"}),C=(0,f.aU)(x),B=(0,E.xI)(x),k=(0,t.createContext)({user:null,loading:!0});function y({children:e}){const[n,a]=(0,t.useState)(null),[o,i]=(0,t.useState)(!0);return(0,t.useEffect)((()=>(0,E.hg)(B,(e=>{a(e),i(!1)}))),[]),r().createElement(k.Provider,{value:{user:n,loading:o}},e)}function w(){return(0,t.useContext)(k)}var S=a(7420),v=a(6109),z=a(9669),T=a(8936);function L(){const{user:e}=w(),[n,a]=(0,t.useState)(""),[o,i]=(0,t.useState)("");return(0,t.useEffect)((()=>{if(e){const n=(0,f.H9)(C,"users",e.uid);(0,f.x7)(n).then((e=>{e.exists()&&e.data().username&&i(e.data().username)}))}}),[e]),r().createElement(S.A,{elevation:6,sx:{px:2,py:1,mb:2,borderRadius:"12px",background:"linear-gradient(135deg, #e5c185 0%, #deae9f 100%)",color:"#fff",maxWidth:"350px",maxHeight:"350px",width:"auto",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)"}},r().createElement(v.A,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"center",flexWrap:"wrap"}},r().createElement(z.A,{variant:"body1",sx:{fontWeight:"bold",whiteSpace:"nowrap"}},"Change Display Name:"),r().createElement(T.A,{variant:"outlined",placeholder:"New username",value:n,onChange:e=>a(e.target.value),sx:{backgroundColor:"#ffffff",borderRadius:"4px",width:"140px","& .MuiOutlinedInput-root":{fontSize:"0.9rem"}}}),r().createElement(l.A,{onClick:async()=>{if(!e)return;const a=(0,f.H9)(C,"users",e.uid);try{await(0,f.BN)(a,{username:n},{merge:!0}),i(n)}catch(e){console.error("Error updating username:",e)}},variant:"contained",sx:{backgroundColor:"#0e7467","&:hover":{backgroundColor:"#1ba494"},color:"#fff",fontWeight:600,borderRadius:"50px",boxShadow:"0px 3px 6px rgba(0,0,0,0.2)",textTransform:"none",fontSize:"0.9rem",py:.6,px:2}},"Save"),o&&r().createElement(z.A,{variant:"body2",sx:{fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.15)",borderRadius:"8px",px:1,py:.5}},"Current username: ",r().createElement("strong",null,o))))}var R=a(5072),W=a.n(R),D=a(7825),N=a.n(D),j=a(7659),I=a.n(j),H=a(5056),G=a.n(H),M=a(540),q=a.n(M),P=a(1113),_=a.n(P),F=a(7617),Y={};function U(){const[e,n]=(0,t.useState)(""),[a,h]=(0,t.useState)([]),[E,x]=(0,t.useState)(!1),[B,k]=(0,t.useState)(!1),[y,S]=(0,t.useState)(!1),v=(0,t.useRef)(null),{user:z}=w(),[T,R]=(0,t.useState)(""),[W,D]=(0,t.useState)(0),[N,j]=(0,t.useState)(0),[I,H]=(0,t.useState)([]),G=I.filter((e=>"default"!==e.uid)),[M,q]=(0,t.useState)({enableGroupStats:!0,enableLeaderboard:!0,enableSharedCoins:!1,showTrophies:!0}),P=[{id:"goldDuck",name:"Golden Duck Trophy",emoji:"🦆✨"},{id:"motivator",name:"Motivator Badge",emoji:"🚀"},{id:"zenMaster",name:"Zen Master",emoji:"🧘‍♂️🌸"},{id:"taskWizard",name:"Task Wizard",emoji:"🧙‍♂️📘"}];function _(e){const[n,a,t]=e.split(":").map(Number);return 60*n+a+t/60}(0,t.useEffect)((()=>(0,f.aQ)((0,f.H9)(C,"groups","globalChat"),(e=>{if(e.exists()){const n=e.data();q({enableGroupStats:!!n.enableGroupStats,enableLeaderboard:!!n.enableLeaderboard,enableSharedCoins:!!n.enableSharedCoins,showTrophies:!!n.showTrophies})}}))),[]),(0,t.useEffect)((()=>{if(z)return(0,f.aQ)((0,f.H9)(C,"users",z.uid),(e=>{e.exists()&&e.data().username?R(e.data().username):R(z.uid)}))}),[z]),(0,t.useEffect)((()=>(0,f.aQ)((0,f.rJ)(C,"globalChat"),(e=>{const n=e.docs.map((e=>e.data())).sort(((e,n)=>e.timestamp?.toDate()-n.timestamp?.toDate()));h(n)}))),[]),(0,t.useEffect)((()=>{v.current?.scrollIntoView({behavior:"smooth"})}),[a]),(0,t.useEffect)((()=>{if(E)return(async()=>{try{const e=await(0,f.x7)((0,f.H9)(C,"coins","default"));D(e.exists()&&e.data().coins||0);const n=await(0,f.x7)((0,f.H9)(C,"statistics","default"));j(n.exists()&&n.data().totalTimeStudied||0)}catch(e){console.error("Error fetching group stats:",e)}})(),(0,f.aQ)((0,f.rJ)(C,"statistics"),(async e=>{let n=e.docs.map((e=>({uid:e.id,time:e.data().totalTimeStudied?_(e.data().totalTimeStudied):0,likes:e.data().likes||0,nudges:e.data().nudges||0})));n=await Promise.all(n.map((async e=>{const[n,a]=await Promise.all([(0,f.x7)((0,f.H9)(C,"users",e.uid)),(0,f.x7)((0,f.H9)(C,"trophies",e.uid))]),t=n.exists()&&n.data().username?n.data().username:e.uid,r=(a.exists()&&a.data().items||[]).map((e=>{const n=P.find((n=>n.id===e));return n?.emoji})).filter(Boolean);return{...e,username:t,trophies:r}}))),n.sort(((e,n)=>n.time-e.time)),H(n)}))}),[E]);const F=async()=>{if(!e.trim()||!z)return;const a={sender:z.uid,username:T,messageID:Date.now().toString(),message:e,timestamp:new Date};try{await(0,f.gS)((0,f.rJ)(C,"globalChat"),a),n("")}catch(e){console.error("Error sending message:",e)}},Y=async(e,n)=>{try{await(0,f.BN)((0,f.H9)(C,"groups","globalChat"),{[e]:n},{merge:!0})}catch(e){console.error("Error updating group setting:",e)}};return E?r().createElement("div",{className:"leaderboard-page",style:{display:"flex",flexDirection:"column",alignItems:"center",padding:20,background:"linear-gradient(135deg, #1ba494, #0e7467)",borderRadius:16,color:"white"}},r().createElement("h2",{style:{fontSize:"2rem",marginBottom:10}},"🏆 Overall Group Statistics!"),r().createElement("div",{style:{width:"100%",maxWidth:400,display:"flex",flexDirection:"column",gap:10,marginBottom:30}},M.enableGroupStats&&r().createElement("div",{style:{background:"rgba(255,255,255,0.15)",borderRadius:12,padding:12}},"⏱️ ",r().createElement("strong",null,"Total Time Studied:")," ",N),M.enableSharedCoins&&r().createElement("div",{style:{background:"rgba(255,255,255,0.15)",borderRadius:12,padding:12}},"💰 ",r().createElement("strong",null,"Total Coins:")," ",W),M.enableLeaderboard&&r().createElement(r().Fragment,null,r().createElement("h2",{style:{fontSize:"2rem",marginBottom:10}},"🥇 Leaderboard"),G.map(((e,n)=>r().createElement("div",{key:e.uid,style:{background:"rgba(255,255,255,0.1)",borderRadius:8,padding:8,display:"flex",justifyContent:"space-between",alignItems:"center"}},r().createElement("div",null,r().createElement("strong",null,n+1,". ",e.username),r().createElement("span",{style:{marginLeft:8}},function(e){const n=Math.floor(60*e),a=Math.floor(n/3600),t=Math.floor(n%3600/60),r=n%60;return`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}(e.time)),M.showTrophies&&e.trophies?.length>0&&r().createElement("div",{style:{marginTop:4,fontSize:"1.2rem"}},e.trophies.join(" "))),r().createElement("div",{style:{display:"flex",gap:6,alignItems:"center"}},r().createElement(i.A,{size:"small",disabled:e.uid===z?.uid,onClick:()=>(async e=>{try{await(0,f.mZ)((0,f.H9)(C,"statistics",e),{likes:(0,f.GV)(1)})}catch(e){console.error("Error sending like:",e)}})(e.uid),sx:{color:"white"}},r().createElement(A.A,{fontSize:"small"})),r().createElement("span",null,e.likes),r().createElement(i.A,{size:"small",disabled:e.uid===z?.uid,onClick:()=>(async e=>{try{await(0,f.mZ)((0,f.H9)(C,"statistics",e),{nudges:(0,f.GV)(1)})}catch(e){console.error("Error sending nudge:",e)}})(e.uid),sx:{color:"white"}},r().createElement(u.A,{fontSize:"small"})),r().createElement("span",null,e.nudges))))))),r().createElement(l.A,{onClick:()=>x(!1),sx:{backgroundColor:"#FF9800",color:"#fff",borderRadius:50,px:4,py:1.5,"&:hover":{backgroundColor:"#e68900"}}},"Back 🔙")):B?r().createElement("div",{className:"change-username-page",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",background:"linear-gradient(135deg, #e5c185, #deae9f)",borderRadius:10,padding:15,color:"white"}},r().createElement(L,null),r().createElement(l.A,{onClick:()=>k(!1),sx:{mt:2,backgroundColor:"#0e7467",color:"#fff",borderRadius:50,px:4,py:1.5,"&:hover":{backgroundColor:"#1ba494"}}},"Back 🔙")):y?r().createElement("div",{className:"settings-page",style:{display:"flex",flexDirection:"column",alignItems:"center",padding:20,background:"linear-gradient(135deg, #1ba494, #0e7467)",borderRadius:16,color:"white",minHeight:"20vh",boxSizing:"border-box"}},r().createElement("h2",{style:{fontSize:"2rem",marginBottom:20}},"🔧 Group Settings"),r().createElement(g.A,{sx:{width:"100%",maxWidth:400,background:"rgba(255,255,255,0.15)",borderRadius:12,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"}},r().createElement(p.A,{sx:{display:"flex",flexDirection:"column",gap:2}},r().createElement(b.A,{control:r().createElement(m.A,{checked:M.showTrophies,onChange:e=>Y("showTrophies",e.target.checked),sx:{"& .MuiSwitch-thumb":{backgroundColor:"#fff"}}}),label:"Show Trophies in Leaderboard",sx:{color:"white",fontSize:"1rem"}}),r().createElement(b.A,{control:r().createElement(m.A,{checked:M.enableGroupStats,onChange:e=>Y("enableGroupStats",e.target.checked),sx:{"& .MuiSwitch-thumb":{backgroundColor:"#fff"}}}),label:"Enable Group Stats",sx:{color:"white",fontSize:"1rem"}}),r().createElement(b.A,{control:r().createElement(m.A,{checked:M.enableLeaderboard,onChange:e=>Y("enableLeaderboard",e.target.checked),sx:{"& .MuiSwitch-thumb":{backgroundColor:"#fff"}}}),label:"Enable Leaderboard",sx:{color:"white",fontSize:"1rem"}}),r().createElement(b.A,{control:r().createElement(m.A,{checked:M.enableSharedCoins,onChange:e=>Y("enableSharedCoins",e.target.checked),sx:{"& .MuiSwitch-thumb":{backgroundColor:"#fff"}}}),label:"Enable Shared Coins",sx:{color:"white",fontSize:"1rem"}}))),r().createElement(l.A,{onClick:()=>S(!1),sx:{mt:4,backgroundColor:"#FF9800",color:"#fff",borderRadius:50,px:4,py:1.5,"&:hover":{backgroundColor:"#e68900"}}},"Back 🔙")):r().createElement("div",{className:"chat-container enhanced"},r().createElement("h2",{className:"chat-title"},T||"Unknown","'s Chat"),r().createElement("div",{className:"chat-box",style:{height:"300px",overflowY:"auto"}},a.map(((e,n)=>{const a=String(e.sender)===String(z?.uid);return r().createElement("div",{key:n,className:"chat-bubble "+(a?"sent":"received")},!a&&r().createElement("strong",{className:"sender"},e.username||e.sender),r().createElement("p",{className:"message"},e.message))})),r().createElement("div",{ref:v})),r().createElement("div",{style:{display:"flex",alignItems:"center",minHeight:"60px",gap:8,marginTop:10}},r().createElement("input",{type:"text",value:e,onChange:e=>n(e.target.value),onKeyDown:e=>"Enter"===e.key&&F(),placeholder:"Type a message...",className:"chat-input"}),r().createElement("button",{onClick:F,className:"send-button"},"Send"),(M.enableGroupStats||M.enableLeaderboard||M.enableSharedCoins)&&r().createElement(o.A,{title:"View Leaderboard / Coins"},r().createElement(i.A,{sx:{backgroundColor:"#e5c185",color:"#fff","&:hover":{backgroundColor:"#deae9f"}},onClick:()=>x(!0)},r().createElement(s.A,null))),r().createElement(o.A,{title:"Change Display Name"},r().createElement(i.A,{sx:{backgroundColor:"#e5c185",color:"#fff","&:hover":{backgroundColor:"#deae9f"}},onClick:()=>k(!0)},r().createElement(d.A,null))),r().createElement(o.A,{title:"Settings"},r().createElement(i.A,{sx:{backgroundColor:"#e5c185",color:"#fff","&:hover":{backgroundColor:"#deae9f"}},onClick:()=>S(!0)},r().createElement(c.A,null)))))}Y.styleTagTransform=_(),Y.setAttributes=G(),Y.insert=I().bind(null,"head"),Y.domAPI=N(),Y.insertStyleElement=q(),W()(F.A,Y),F.A&&F.A.locals&&F.A.locals;var Z=a(5852);function O({onLogin:e}){const[n,a]=(0,t.useState)(!0),[o,i]=(0,t.useState)(""),[s,d]=(0,t.useState)("");return r().createElement(v.A,{sx:{maxWidth:320,mx:"auto",textAlign:"center",mt:8}},r().createElement(z.A,{variant:"h5",sx:{mb:2}},n?"Login":"Sign Up"),r().createElement(T.A,{label:"Email",type:"email",fullWidth:!0,margin:"normal",value:o,onChange:e=>i(e.target.value)}),r().createElement(T.A,{label:"Password",type:"password",fullWidth:!0,margin:"normal",value:s,onChange:e=>d(e.target.value)}),r().createElement(l.A,{variant:"contained",fullWidth:!0,sx:{mt:2},onClick:async()=>{try{const a=n?await(0,E.x9)(B,o,s):await(0,E.eJ)(B,o,s);e(a.user.uid)}catch(e){alert(`Auth failed: ${e.message}`)}}},n?"Login":"Sign Up"),r().createElement(z.A,{variant:"body2",sx:{mt:2}},n?"Don't have an account?":"Already have an account?"," ",r().createElement(Z.A,{component:"button",variant:"body2",onClick:()=>a(!n)},n?"Sign Up":"Login")))}function Q(){const{user:e,loading:n}=w();return n?r().createElement("div",null,"Loading..."):e?r().createElement(U,null):r().createElement(O,{onLogin:()=>console.log("User logged in")})}function V(){return r().createElement(y,null,r().createElement(Q,null))}},7617:(e,n,a)=>{a.d(n,{A:()=>l});var t=a(4860),r=a.n(t),o=a(7028),i=a.n(o)()(r());i.push([e.id,"/* Chat.css */\n.chat-container.enhanced {\n  width: 100%;\n  max-width: 600px;\n  margin: 20px auto;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n  border-radius: 10px;\n  overflow: hidden;\n  background-color: #fff;\n  font-family: 'Arial', sans-serif;\n}\n\n.chat-title {\n  background-color: #1ba494;\n  color: white;\n  padding: 15px;\n  text-align: center;\n  margin: 0;\n}\n\n.chat-box {\n  height: 400px;\n  overflow-y: auto;\n  padding: 15px;\n  background-color: #f9f9f9;\n}\n\n.chat-bubble {\n  margin-bottom: 10px;\n  padding: 10px 15px;\n  border-radius: 20px;\n  max-width: 70%;\n  word-wrap: break-word;\n}\n\n.chat-bubble.sent {\n  background-color: #dcf8c6;\n  margin-left: auto;\n  text-align: right;\n}\n\n.chat-bubble.received {\n  background-color: #fff;\n  border: 1px solid #ddd;\n  text-align: left;\n}\n\n.sender {\n  font-size: 0.8em;\n  color: #555;\n  display: block;\n  margin-bottom: 5px;\n}\n\n.shared-image {\n  max-width: 100%;\n  border-radius: 10px;\n  margin-top: 5px;\n}\n\n.chat-input-container {\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border-top: 1px solid #ddd;\n  background-color: #fafafa;\n}\n\n.chat-input {\n  flex: 1;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 20px;\n  margin-right: 10px;\n}\n\n.image-upload-input {\n  margin-right: 10px;\n}\n\n.send-button {\n  padding: 10px 20px;\n  background-color: #1ba494;\n  color: white;\n  border: none;\n  border-radius: 20px;\n  cursor: pointer;\n}\n\n.leaderboard-page {\n  /* Centering the content */\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n\n  /* Padding/margins for breathing room */\n  margin: 0 auto;\n  padding: 20px;\n\n  /* Font settings */\n  font-family: \"Roboto\", sans-serif; \n  color: #00796b; \n}\n\n.leaderboard-page h2 {\n  font-size: 2em;\n  margin-bottom: 10px;\n}\n\n.leaderboard-page p {\n  font-size: 1.2em;\n  line-height: 1.5;\n}\n","",{version:3,sources:["webpack://./src/Chat.css"],names:[],mappings:"AAAA,aAAa;AACb;EACE,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,qCAAqC;EACrC,mBAAmB;EACnB,gBAAgB;EAChB,sBAAsB;EACtB,gCAAgC;AAClC;;AAEA;EACE,yBAAyB;EACzB,YAAY;EACZ,aAAa;EACb,kBAAkB;EAClB,SAAS;AACX;;AAEA;EACE,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,yBAAyB;AAC3B;;AAEA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,mBAAmB;EACnB,cAAc;EACd,qBAAqB;AACvB;;AAEA;EACE,yBAAyB;EACzB,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,sBAAsB;EACtB,sBAAsB;EACtB,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;EAChB,WAAW;EACX,cAAc;EACd,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,mBAAmB;EACnB,eAAe;AACjB;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,aAAa;EACb,0BAA0B;EAC1B,yBAAyB;AAC3B;;AAEA;EACE,OAAO;EACP,aAAa;EACb,sBAAsB;EACtB,mBAAmB;EACnB,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,yBAAyB;EACzB,YAAY;EACZ,YAAY;EACZ,mBAAmB;EACnB,eAAe;AACjB;;AAEA;EACE,0BAA0B;EAC1B,aAAa;EACb,sBAAsB;EACtB,mBAAmB;EACnB,uBAAuB;EACvB,kBAAkB;;EAElB,uCAAuC;EACvC,cAAc;EACd,aAAa;;EAEb,kBAAkB;EAClB,iCAAiC;EACjC,cAAc;AAChB;;AAEA;EACE,cAAc;EACd,mBAAmB;AACrB;;AAEA;EACE,gBAAgB;EAChB,gBAAgB;AAClB",sourcesContent:["/* Chat.css */\n.chat-container.enhanced {\n  width: 100%;\n  max-width: 600px;\n  margin: 20px auto;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n  border-radius: 10px;\n  overflow: hidden;\n  background-color: #fff;\n  font-family: 'Arial', sans-serif;\n}\n\n.chat-title {\n  background-color: #1ba494;\n  color: white;\n  padding: 15px;\n  text-align: center;\n  margin: 0;\n}\n\n.chat-box {\n  height: 400px;\n  overflow-y: auto;\n  padding: 15px;\n  background-color: #f9f9f9;\n}\n\n.chat-bubble {\n  margin-bottom: 10px;\n  padding: 10px 15px;\n  border-radius: 20px;\n  max-width: 70%;\n  word-wrap: break-word;\n}\n\n.chat-bubble.sent {\n  background-color: #dcf8c6;\n  margin-left: auto;\n  text-align: right;\n}\n\n.chat-bubble.received {\n  background-color: #fff;\n  border: 1px solid #ddd;\n  text-align: left;\n}\n\n.sender {\n  font-size: 0.8em;\n  color: #555;\n  display: block;\n  margin-bottom: 5px;\n}\n\n.shared-image {\n  max-width: 100%;\n  border-radius: 10px;\n  margin-top: 5px;\n}\n\n.chat-input-container {\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border-top: 1px solid #ddd;\n  background-color: #fafafa;\n}\n\n.chat-input {\n  flex: 1;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 20px;\n  margin-right: 10px;\n}\n\n.image-upload-input {\n  margin-right: 10px;\n}\n\n.send-button {\n  padding: 10px 20px;\n  background-color: #1ba494;\n  color: white;\n  border: none;\n  border-radius: 20px;\n  cursor: pointer;\n}\n\n.leaderboard-page {\n  /* Centering the content */\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n\n  /* Padding/margins for breathing room */\n  margin: 0 auto;\n  padding: 20px;\n\n  /* Font settings */\n  font-family: \"Roboto\", sans-serif; \n  color: #00796b; \n}\n\n.leaderboard-page h2 {\n  font-size: 2em;\n  margin-bottom: 10px;\n}\n\n.leaderboard-page p {\n  font-size: 1.2em;\n  line-height: 1.5;\n}\n"],sourceRoot:""}]);const l=i}}]);
//# sourceMappingURL=748.dec0c702bf75e1e17591.js.map